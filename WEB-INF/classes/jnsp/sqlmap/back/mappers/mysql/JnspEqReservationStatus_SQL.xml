<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="info.elsys.jnsp.back.module.service.impl.JnspEqReservationStatusMapper">

	<sql id="oracle_pageHeader">
		SELECT * FROM (
			SELECT ROWNUM RN , PAGE.* FROM (
	</sql>
	<sql id="oracle_pageFooter">
			) PAGE
		)
		WHERE RN BETWEEN ${firstRecord} AND ${lastRecord}
	</sql>

	<!-- ONLINE, OFFLINE 예약건수 가져오기 (연차별) -->
	<select id="getEqReservationYearCntList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%Y') AS `DATE`
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_ORDER A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.ORDER_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						
						
						<if test='searchText != "" and searchGb == "a1"'>
						<![CDATA[
							AND D2.OWN_ORG_NM LIKE '%${searchText}%'
						]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
						<![CDATA[
							AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
						]]>
						</if>
						
						
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
		<![CDATA[
					) AS TOTAL_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_ORDER A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.ORDER_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							A2.ORDER_TYPE = "ONLINE"
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						
						<if test='searchText != "" and searchGb == "a1"'>
						<![CDATA[
							AND D2.OWN_ORG_NM LIKE '%${searchText}%'
						]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
						<![CDATA[
							AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
						]]>
						</if>
						
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_ORDER A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.ORDER_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							A2.ORDER_TYPE = "OFFLINE"
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						
						<if test='searchText != "" and searchGb == "a1"'>
						<![CDATA[
							AND D2.OWN_ORG_NM LIKE '%${searchText}%'
						]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
						<![CDATA[
							AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
						]]>
						</if>
						
		<![CDATA[
					) AS OFFLINE_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y')
					) E
		]]>
	</select>

	<!-- ONLINE, OFFLINE 예약건수 가져오기 (월별) -->
	<select id="getEqReservationMonthCntList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%m') AS `DATE`
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_ORDER A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.ORDER_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS TOTAL_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_ORDER A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.ORDER_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							A2.ORDER_TYPE = "ONLINE"
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_ORDER A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.ORDER_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							A2.ORDER_TYPE = "OFFLINE"
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						AND
							DATE_FORMAT(selected_date, '%Y') = #{searchYear}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y-%m')
					) E
		]]>
	</select>

	<!-- ONLINE, OFFLINE 예약건수 가져오기 (일별) -->
	<select id="getEqReservationDayCntList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%d') AS `DATE`
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_ORDER A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.ORDER_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS TOTAL_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_ORDER A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.ORDER_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							A2.ORDER_TYPE = "ONLINE"
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_ORDER A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.ORDER_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							A2.ORDER_TYPE = "OFFLINE"
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						AND
							DATE_FORMAT(selected_date, '%Y-%m') = #{searchMonth}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y-%m-%d')
					) E
		]]>
	</select>

	<!-- 예약·내부활용 처리건수 가져오기 (연차별) -->
	<select id="getEqReservationDiaryYearCntList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%Y') AS `DATE`
					, (
						SELECT 
								COUNT(0)
						FROM 
							TB_EQU_OPER_DIARY A2
						LEFT JOIN 
								TB_EQU_ORDER B2 
						ON 
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX 
						LEFT JOIN 
								TB_EQU_INFO C2 
						ON 
								A2.RND_EQU_IDX = C2.RND_EQU_IDX 
						LEFT JOIN 
								TB_EQU_GOODS D2 
						ON 
								A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE 
							( A2.REPORT_TYPE = 'diary' OR A2.REPORT_TYPE = 'inner' )
						AND 
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
		]]>
				<if test='authLv != "99" and authLv >= "70"'>
					<![CDATA[
						AND D2.OWN_ORG = #{orgGrpCd}
					]]>
				</if>
				<if test='authLv != "99" and authLv == "70"'>
					<![CDATA[
						AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
					]]>
				</if>
				<if test='searchText != "" and searchGb == "a1"'>
					<![CDATA[
						AND D2.OWN_ORG_NM LIKE '%${searchText}%'
					]]>
				</if>
				<if test='searchText != "" and searchGb == "a2"'>
					<![CDATA[
						AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
					]]>
				</if>
		<![CDATA[
					) AS DIARY_TCNT,
					(
						SELECT 
								COUNT(0)
						FROM 
								TB_EQU_OPER_LEGAL A2
						WHERE 1=1
						AND 
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
		]]>
				<if test='authLv != "99" and authLv >= "70"'>
					<![CDATA[
						AND A2.REG_ORG_GRP_CD = #{orgGrpCd}
					]]>
				</if>
				<if test='authLv != "99" and authLv == "70"'>
					<![CDATA[
						AND A2.REG_DEPT_NM = #{orgSubGrpCd}
					]]>
				</if>
		<![CDATA[
					) AS LEGAL_TCNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							B2.ORDER_TYPE = "ONLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							B2.ORDER_TYPE = "OFFLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_LEGAL A2
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND A2.REG_ORG_GRP_CD = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND A2.REG_DEPT_NM = #{orgSubGrpCd}
							]]>
						</if>
		<![CDATA[
					) AS LEGAL_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							A2.REPORT_TYPE = 'inner'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS INNER_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y')
					) E
		]]>
	</select>

	<!-- 예약·내부활용 처리건수 가져오기 (월별) -->
	<select id="getEqReservationDiaryMonthCntList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%m') AS `DATE`
					, (
						SELECT 
								COUNT(0)
						FROM 
							TB_EQU_OPER_DIARY A2
						LEFT JOIN 
								TB_EQU_ORDER B2 
						ON 
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX 
						LEFT JOIN 
								TB_EQU_INFO C2 
						ON 
								A2.RND_EQU_IDX = C2.RND_EQU_IDX 
						LEFT JOIN 
								TB_EQU_GOODS D2 
						ON 
								A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE 
							( A2.REPORT_TYPE = 'diary' OR A2.REPORT_TYPE = 'inner' )
						AND 
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
		]]>
				<if test='authLv != "99" and authLv >= "70"'>
					<![CDATA[
						AND D2.OWN_ORG = #{orgGrpCd}
					]]>
				</if>
				<if test='authLv != "99" and authLv == "70"'>
					<![CDATA[
						AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
					]]>
				</if>
				<if test='searchText != "" and searchGb == "a1"'>
					<![CDATA[
						AND D2.OWN_ORG_NM LIKE '%${searchText}%'
					]]>
				</if>
				<if test='searchText != "" and searchGb == "a2"'>
					<![CDATA[
						AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
					]]>
				</if>
		<![CDATA[
					) AS DIARY_TCNT,
					(
						SELECT 
								COUNT(0)
						FROM 
								TB_EQU_OPER_LEGAL A2
						WHERE 1=1
						AND 
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
		]]>
				<if test='authLv != "99" and authLv >= "70"'>
					<![CDATA[
						AND A2.REG_ORG_GRP_CD = #{orgGrpCd}
					]]>
				</if>
				<if test='authLv != "99" and authLv == "70"'>
					<![CDATA[
						AND A2.REG_DEPT_NM = #{orgSubGrpCd}
					]]>
				</if>
		<![CDATA[
					) AS LEGAL_TCNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							B2.ORDER_TYPE = "ONLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							B2.ORDER_TYPE = "OFFLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_LEGAL A2
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND A2.REG_ORG_GRP_CD = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND A2.REG_DEPT_NM = #{orgSubGrpCd}
							]]>
						</if>
		<![CDATA[
					) AS LEGAL_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							A2.REPORT_TYPE = 'inner'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS INNER_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						AND
							DATE_FORMAT(selected_date, '%Y') = #{searchYear}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y-%m')
					) E
		]]>
	</select>

	<!-- 예약·내부활용 처리건수 가져오기 (일별) -->
	<select id="getEqReservationDiaryDayCntList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%d') AS `DATE`
					, (
						SELECT 
								COUNT(0)
						FROM 
							TB_EQU_OPER_DIARY A2
						LEFT JOIN 
								TB_EQU_ORDER B2 
						ON 
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX 
						LEFT JOIN 
								TB_EQU_INFO C2 
						ON 
								A2.RND_EQU_IDX = C2.RND_EQU_IDX 
						LEFT JOIN 
								TB_EQU_GOODS D2 
						ON 
								A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE 
							( A2.REPORT_TYPE = 'diary' OR A2.REPORT_TYPE = 'inner' )
						AND 
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d') 
		]]>
				<if test='authLv != "99" and authLv >= "70"'>
					<![CDATA[
						AND D2.OWN_ORG = #{orgGrpCd}
					]]>
				</if>
				<if test='authLv != "99" and authLv == "70"'>
					<![CDATA[
						AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
					]]>
				</if>
				<if test='searchText != "" and searchGb == "a1"'>
					<![CDATA[
						AND D2.OWN_ORG_NM LIKE '%${searchText}%'
					]]>
				</if>
				<if test='searchText != "" and searchGb == "a2"'>
					<![CDATA[
						AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
					]]>
				</if>
		<![CDATA[
					) AS DIARY_TCNT,
					(
						SELECT 
								COUNT(0)
						FROM 
								TB_EQU_OPER_LEGAL A2
						WHERE 1=1
						AND 
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d') 
		]]>
				<if test='authLv != "99" and authLv >= "70"'>
					<![CDATA[
						AND A2.REG_ORG_GRP_CD = #{orgGrpCd}
					]]>
				</if>
				<if test='authLv != "99" and authLv == "70"'>
					<![CDATA[
						AND A2.REG_DEPT_NM = #{orgSubGrpCd}
					]]>
				</if>
		<![CDATA[
					) AS LEGAL_TCNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							B2.ORDER_TYPE = "ONLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							B2.ORDER_TYPE = "OFFLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_LEGAL A2
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND A2.REG_ORG_GRP_CD = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND A2.REG_DEPT_NM = #{orgSubGrpCd}
							]]>
						</if>
		<![CDATA[
					) AS LEGAL_CNT
					, (
						SELECT
							COUNT(0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							A2.REPORT_TYPE = 'inner'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS INNER_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						AND
							DATE_FORMAT(selected_date, '%Y-%m') = #{searchMonth}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y-%m-%d')
					) E
		]]>
	</select>

	<!-- 장비활용건수 가져오기 (연차별) -->
	<select id="getEqReservationEquUseYearCntList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%Y') AS `DATE`
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							(
								(A2.REPORT_TYPE = 'diary')
								OR (A2.REPORT_TYPE = 'legal')
								OR (A2.REPORT_TYPE = 'inner')
							)
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS TOTAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							B2.ORDER_TYPE = "ONLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							B2.ORDER_TYPE = "OFFLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							A2.REPORT_TYPE = 'legal'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS LEGAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							A2.REPORT_TYPE = 'inner'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS INNER_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y')
					) E
		]]>
	</select>

	<!-- 장비활용건수 가져오기 (월별) -->
	<select id="getEqReservationEquUseMonthCntList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%m') AS `DATE`
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							(
								(A2.REPORT_TYPE = 'diary')
								OR (A2.REPORT_TYPE = 'legal')
								OR (A2.REPORT_TYPE = 'inner')
							)
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS TOTAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							B2.ORDER_TYPE = "ONLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							B2.ORDER_TYPE = "OFFLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							A2.REPORT_TYPE = 'legal'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS LEGAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							A2.REPORT_TYPE = 'inner'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS INNER_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						AND
							DATE_FORMAT(selected_date, '%Y') = #{searchYear}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y-%m')
					) E
		]]>
	</select>

	<!-- 장비활용건수 가져오기 (일별) -->
	<select id="getEqReservationEquUseDayCntList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%d') AS `DATE`
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							(
								(A2.REPORT_TYPE = 'diary')
								OR (A2.REPORT_TYPE = 'legal')
								OR (A2.REPORT_TYPE = 'inner')
							)
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS TOTAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							B2.ORDER_TYPE = "ONLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							B2.ORDER_TYPE = "OFFLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							A2.REPORT_TYPE = 'legal'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS LEGAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.SAMPLE_CNT),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							A2.REPORT_TYPE = 'inner'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS INNER_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						AND
							DATE_FORMAT(selected_date, '%Y-%m') = #{searchMonth}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y-%m-%d')
					) E
		]]>
	</select>

	<!-- 장비작동시간 가져오기 (연차별) -->
	<select id="getEqReservationEquUseTimeYearList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%Y') AS `DATE`
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							(
								(A2.REPORT_TYPE = 'diary')
								OR (A2.REPORT_TYPE = 'legal')
								OR (A2.REPORT_TYPE = 'inner')
							)
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS TOTAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							B2.ORDER_TYPE = "ONLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							B2.ORDER_TYPE = "OFFLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							A2.REPORT_TYPE = 'legal'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS LEGAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y') = DATE_FORMAT(E.selected_date, '%Y')
						AND
							A2.REPORT_TYPE = 'inner'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS INNER_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y')
					) E
		]]>
	</select>

	<!-- 장비작동시간 가져오기 (월별) -->
	<select id="getEqReservationEquUseTimeMonthList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%m') AS `DATE`
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							(
								(A2.REPORT_TYPE = 'diary')
								OR (A2.REPORT_TYPE = 'legal')
								OR (A2.REPORT_TYPE = 'inner')
							)
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS TOTAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							B2.ORDER_TYPE = "ONLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							B2.ORDER_TYPE = "OFFLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							A2.REPORT_TYPE = 'legal'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS LEGAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m') = DATE_FORMAT(E.selected_date, '%Y-%m')
						AND
							A2.REPORT_TYPE = 'inner'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS INNER_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						AND
							DATE_FORMAT(selected_date, '%Y') = #{searchYear}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y-%m')
					) E
		]]>
	</select>

	<!-- 장비작동시간 가져오기 (일별) -->
	<select id="getEqReservationEquUseTimeDayList" parameterType="paramMap" resultType="paramMap" >
		<![CDATA[
			SELECT
					DATE_FORMAT(E.selected_date, '%d') AS `DATE`
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							(
								(A2.REPORT_TYPE = 'diary')
								OR (A2.REPORT_TYPE = 'legal')
								OR (A2.REPORT_TYPE = 'inner')
							)
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS TOTAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							B2.ORDER_TYPE = "ONLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS ONLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_ORDER B2
						ON
							B2.EQU_ORDER_IDX = A2.EQU_ORDER_IDX
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							B2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							B2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							B2.ORDER_TYPE = "OFFLINE"
						AND
							B2.DIARY_YN ='Y'
						AND
							A2.REPORT_TYPE = 'diary'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS OFFLINE_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							A2.REPORT_TYPE = 'legal'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS LEGAL_CNT
					, (
						SELECT
							IFNULL(SUM(A2.USE_TIME),0)
						FROM
							TB_EQU_OPER_DIARY A2
						LEFT JOIN
							TB_EQU_INFO C2
						ON
							A2.RND_EQU_IDX = C2.RND_EQU_IDX
						LEFT JOIN
							TB_EQU_GOODS D2
						ON
							A2.RND_EQU_IDX = D2.RND_EQU_IDX
						WHERE
							DATE_FORMAT(A2.REG_DT, '%Y-%m-%d') = DATE_FORMAT(E.selected_date, '%Y-%m-%d')
						AND
							A2.REPORT_TYPE = 'inner'
		]]>
						<if test='authLv != "99" and authLv >= "70"'>
							<![CDATA[
								AND D2.OWN_ORG = #{orgGrpCd}
							]]>
						</if>
						<if test='authLv != "99" and authLv == "70"'>
							<![CDATA[
								AND D2.OWN_ORG_SUB_NM = #{orgSubGrpCd}
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a1"'>
							<![CDATA[
								AND D2.OWN_ORG_NM LIKE '%${searchText}%'
							]]>
						</if>
						<if test='searchText != "" and searchGb == "a2"'>
							<![CDATA[
								AND (C2.KOR_NM LIKE '%${searchText}%' OR C2.ENG_NM LIKE '%${searchText}%')
							]]>
						</if>
		<![CDATA[
					) AS INNER_CNT
			FROM
					(
						SELECT
							selected_date AS selected_date
						FROM
							(
								SELECT
									ADDDATE(#{searchStDt},t4*10000 + t3*1000 + t2*100 + t1*10 + t0) selected_date
								FROM
									(SELECT 0 t0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t0,
									(SELECT 0 t1 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
									(SELECT 0 t2 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
									(SELECT 0 t3 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
									(SELECT 0 t4 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t4
							) v
						WHERE
							selected_date BETWEEN #{searchStDt} AND #{searchEdDt}
						AND
							DATE_FORMAT(selected_date, '%Y-%m') = #{searchMonth}
						GROUP BY
							DATE_FORMAT(selected_date, '%Y-%m-%d')
					) E
		]]>
	</select>

</mapper>